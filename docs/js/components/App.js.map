{"version":3,"file":"App.js","sourceRoot":"","sources":["../../ts/components/App.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Signal, useSignal } from '@preact/signals'\nimport { useEffect, useRef } from 'preact/hooks'\nimport { requestAccounts, isValidEnsSubDomain, isChildOwnershipOwnedByOpenRenewManager, getAccounts, getDomainInfos, isPetalLockAndOpenRenewalManagerDeployed, getOpenRenewalManagerAddress, areRequiredFusesBurntWithoutApproval, isChildOwnershipGivenAway } from '../utils/ensUtils.js'\nimport { BigSpinner } from './Spinner.js'\nimport { ensureError } from '../utils/utilities.js'\nimport { AccountAddress, CheckBoxes, DomainInfo, FinalChildChecks, ParentChecks } from '../types/types.js'\nimport { Create, Immutable, Requirements } from './requirements.js'\nimport { OptionalSignal, useOptionalSignal } from '../utils/OptionalSignal.js'\nimport { getChainId } from '../utils/ensUtils.js'\n\ninterface WalletComponentProps {\n\tmaybeAccountAddress: OptionalSignal<AccountAddress>\n\tloadingAccount: Signal<boolean>\n\tisWindowEthereum: Signal<boolean>\n}\n\nconst WalletComponent = ({ maybeAccountAddress, loadingAccount, isWindowEthereum }: WalletComponentProps) => {\n\tif (!isWindowEthereum.value) return <p class = 'paragraph'> An Ethereum enabled wallet is required to make almost* immutable domains.</p>\n\tif (loadingAccount.value) return <></>\n\tconst connect = async () => {\n\t\tmaybeAccountAddress.deepValue = await requestAccounts()\n\t}\n\treturn maybeAccountAddress.value !== undefined ? (\n\t\t<p style = 'color: gray; justify-self: right;'>{ `Connected with ${ maybeAccountAddress.value }` }</p>\n\t) : (\n\t\t<button class = 'button is-primary' style = 'justify-self: right;' onClick = { connect }>\n\t\t\t{ `Connect wallet` }\n\t\t</button>\n\t)\n}\n\ninterface LoadingSpinnerProps {\n\tloading: boolean\n}\nconst LoadingSpinner = ({ loading }: LoadingSpinnerProps) => {\n\tif (loading === false) return <></>\n\treturn <div style = 'max-width: fit-content; margin-inline: auto; padding: 20px;'>\n\t\t<BigSpinner/>\n\t</div>\n}\n\ntype ErrorComponentProps  = { displayError: boolean, message: string } | { message: OptionalSignal<string> }\nconst ErrorComponent = (props: ErrorComponentProps) => {\n\tif (!('displayError' in props)) {\n\t\tif (props.message.value === undefined) return <></>\n\t\treturn <p class = 'error-component'> { props.message.value } </p>\n\t}\n\tif (props.displayError === false) return <></>\n\treturn <p class = 'error-component'> { props.message } </p>\n}\n\ninterface EnsRegistryErrorProps {\n\tcheckBoxes: OptionalSignal<CheckBoxes>\n}\nconst EnsRegistryError = ({ checkBoxes }: EnsRegistryErrorProps) => {\n\tif (checkBoxes.deepValue === undefined || checkBoxes.deepValue[0] === undefined || checkBoxes.deepValue[0].exists) return <></>\n\treturn <p style = 'color: #b43c42'>\n\t\t{ `The name ${ checkBoxes.deepValue[0].domainInfo.label } does not exist in the ENS registry. You need to register the domain to use PetalLock.` }\n\t</p>\n}\n\nexport function App() {\n\tconst inputValue = useSignal<string>('')\n\tconst contentHashInput = useSignal<string>('')\n\tconst resolutionAddressInput = useSignal<string>('')\n\tconst errorString = useOptionalSignal<string>(undefined)\n\tconst loadingAccount = useSignal<boolean>(false)\n\tconst isWindowEthereum = useSignal<boolean>(true)\n\tconst areContractsDeployed = useSignal<boolean | undefined>(undefined)\n\tconst maybeAccountAddress = useOptionalSignal<AccountAddress>(undefined)\n\tconst chainId = useSignal<number | undefined>(undefined)\n\tconst pathInfo = useOptionalSignal<DomainInfo[]>(undefined)\n\tconst immutable = useSignal<boolean>(false)\n\tconst checkBoxes = useOptionalSignal<CheckBoxes>(undefined)\n\tconst loadingInfos = useSignal<boolean>(false)\n\tconst creating = useSignal<boolean>(false)\n\tconst inputTimeoutRef = useRef<number | null>(null)\n\tconst extendYear = useSignal<number>(1)\n\tconst extending = useSignal<boolean>(false)\n\n\tconst setError = (error: unknown) => {\n\t\tif (error === undefined) {\n\t\t\terrorString.value = undefined\n\t\t\treturn\n\t\t}\n\t\tconst ensured = ensureError(error)\n\t\terrorString.deepValue = ensured.message\n\t}\n\n\tconst clear = () => {\n\t\tpathInfo.value = undefined\n\t\tloadingInfos.value = false\n\t\tcheckBoxes.value = undefined\n\t\timmutable.value = false\n\t}\n\n\tconst updateInfos = async (showLoading: boolean) => {\n\t\tconst ensSubDomain = inputValue.value.toLowerCase()\n\t\ttry {\n\t\t\tif (!isValidEnsSubDomain(ensSubDomain)) return\n\t\t\tif (loadingInfos.value) return // already loading\n\t\t\tif (showLoading) loadingInfos.value = true\n\t\t\tconst newPathInfo = await getDomainInfos(maybeAccountAddress.deepValue, ensSubDomain)\n\t\t\tpathInfo.deepValue = newPathInfo\n\t\t\timmutable.value = false\n\t\t\tcheckBoxes.deepValue = newPathInfo.map((currElement, index): FinalChildChecks | ParentChecks => {\n\t\t\t\tconst fusesBurned = areRequiredFusesBurntWithoutApproval(index, newPathInfo)\n\t\t\t\tconst base = {\n\t\t\t\t\texists: currElement.registered,\n\t\t\t\t\tisWrapped: currElement.isWrapped,\n\t\t\t\t\tfusesBurned,\n\t\t\t\t\tdomainInfo: currElement,\n\t\t\t\t}\n\t\t\t\tif (index === newPathInfo.length - 1) {\n\t\t\t\t\timmutable.value = currElement.isWrapped && fusesBurned && isChildOwnershipGivenAway(currElement)\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...base,\n\t\t\t\t\t\ttype: 'finalChild' as const,\n\t\t\t\t\t\townershipOpenRenewalContract: isChildOwnershipOwnedByOpenRenewManager(currElement),\n\t\t\t\t\t\tchildOwnershipIsGivenAway: isChildOwnershipGivenAway(currElement),\n\t\t\t\t\t\timmutable: immutable.value,\n\t\t\t\t\t\tcontentHashIsSet: currElement.contentHash !== '0x',\n\t\t\t\t\t\tresolutionAddressIsSet: BigInt(currElement.resolutionAddress) !== 0n,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\t...base,\n\t\t\t\t\ttype: 'parent' as const,\n\t\t\t\t\topenRenewalContractIsApproved: currElement.approved === getOpenRenewalManagerAddress() && currElement.fuses.includes('Cannot Approve')\n\t\t\t\t}\n\t\t\t})\n\t\t\terrorString.value = undefined\n\t\t} catch(e: unknown) {\n\t\t\tsetError(e)\n\t\t} finally {\n\t\t\tloadingInfos.value = false\n\t\t\tif (inputValue.value.toLowerCase() !== ensSubDomain) await updateInfos(showLoading)\n\t\t}\n\t}\n\n\tfunction handleInput(value: string) {\n\t\tinputValue.value = value\n\t\tif (inputTimeoutRef.current !== null) clearTimeout(inputTimeoutRef.current)\n\t\tinputTimeoutRef.current = setTimeout(() => {\n\t\t\tinputTimeoutRef.current = null\n\t\t\tconst ensSubDomain = inputValue.value.toLowerCase()\n\t\t\tif (!isValidEnsSubDomain(ensSubDomain)) {\n\t\t\t\tclear()\n\t\t\t\treturn setError(`${ ensSubDomain } is not a valid ENS subdomain. The format should be similar to \"2.horswap.eth\" or \"1.lunaria.darkflorist.eth\".`)\n\t\t\t}\n\t\t\tsetError(undefined)\n\t\t\tupdateInfos(true)\n\t\t}, 500)\n\t}\n\n\tfunction handleContentHashInput(value: string) {\n\t\tcontentHashInput.value = value\n\t}\n\tfunction handleResolutionAddressInput(value: string) {\n\t\tresolutionAddressInput.value = value\n\t}\n\n\tconst updateChainId = async () => {\n\t\tconst account = maybeAccountAddress.deepPeek()\n\t\tif (account === undefined) return\n\t\tchainId.value = await getChainId(account)\n\t}\n\n\tuseEffect(() => {\n\t\tif (window.ethereum === undefined) {\n\t\t\tisWindowEthereum.value = false\n\t\t\treturn\n\t\t}\n\t\tisWindowEthereum.value = true\n\t\twindow.ethereum.on('accountsChanged', function (accounts) { maybeAccountAddress.deepValue = accounts[0] })\n\t\twindow.ethereum.on('chainChanged', async () => { updateChainId() })\n\t\tconst fetchAccount = async () => {\n\t\t\ttry {\n\t\t\t\tloadingAccount.value = true\n\t\t\t\tconst fetchedAccount = await getAccounts()\n\t\t\t\tif (fetchedAccount) maybeAccountAddress.deepValue = fetchedAccount\n\t\t\t\tupdateChainId()\n\t\t\t} catch(e) {\n\t\t\t\tsetError(e)\n\t\t\t} finally {\n\t\t\t\tloadingAccount.value = false\n\t\t\t\tareContractsDeployed.value = await isPetalLockAndOpenRenewalManagerDeployed(maybeAccountAddress.deepValue)\n\t\t\t}\n\t\t}\n\t\tfetchAccount()\n\t\treturn () => {\n\t\t\tif (inputTimeoutRef.current !== null) {\n\t\t\t\tclearTimeout(inputTimeoutRef.current)\n\t\t\t}\n\t\t}\n\t}, [])\n\n\tuseEffect(() => {\n\t\tupdateInfos(true)\n\t\tupdateChainId()\n\t}, [maybeAccountAddress.value])\n\n\treturn <main style = 'overflow: auto;'>\n\t\t<div class = 'app'>\n\t\t\t<WalletComponent loadingAccount = { loadingAccount } isWindowEthereum = { isWindowEthereum } maybeAccountAddress = { maybeAccountAddress } />\n\t\t\t<div style = 'display: block'>\n\t\t\t\t<div class = 'petal-lock'>\n\t\t\t\t\t<img src = 'favicon.svg' alt = 'Icon' style ='width: 60px;'/> PetalLock\n\t\t\t\t</div>\n\t\t\t\t<p class = 'sub-title'>Make almost* immutable ENS domains and subdomains</p>\n\t\t\t</div>\n\n\t\t\t<input\n\t\t\t\tclass = 'input'\n\t\t\t\ttype = 'text'\n\t\t\t\tstyle = { 'width: 100%;'}\n\t\t\t\tplaceholder = '2.horswap.eth'\n\t\t\t\tvalue = { inputValue.value }\n\t\t\t\tonInput = { e => handleInput(e.currentTarget.value) }\n\t\t\t/>\n\n\t\t\t<LoadingSpinner loading = { loadingInfos.value === true || loadingAccount.value }/>\n\t\t\t<ErrorComponent message = { errorString }/>\n\t\t\t<ErrorComponent displayError = { chainId.value !== undefined && chainId.value !== 1 } message = { 'PetalLock functions only on Ethereum Mainnet. Please switch to Ethereum Mainnet.' }/>\n\t\t\t<EnsRegistryError checkBoxes = { checkBoxes } />\n\t\t\t<Immutable checkBoxesArray = { checkBoxes } />\n\t\t\t<Requirements checkBoxesArray = { checkBoxes }/>\n\n\t\t\t<Create\n\t\t\t\tcontentHashInput = { contentHashInput }\n\t\t\t\thandleContentHashInput = { handleContentHashInput }\n\t\t\t\tresolutionAddressInput = { resolutionAddressInput }\n\t\t\t\thandleResolutionAddressInput = { handleResolutionAddressInput }\n\t\t\t\tloadingInfos = { loadingInfos }\n\t\t\t\timmutable = { immutable }\n\t\t\t\tmaybeAccountAddress = { maybeAccountAddress }\n\t\t\t\tcheckBoxes = { checkBoxes }\n\t\t\t\tupdateInfos = { updateInfos }\n\t\t\t\tcreating = { creating }\n\t\t\t\tareContractsDeployed = { areContractsDeployed }\n\t\t\t\textendYear = { extendYear }\n\t\t\t\textending = { extending }\n\t\t\t/>\n\t\t</div>\n\t\t<div class = 'text-white/50 text-center'>\n\t\t\t<p style = 'max-width: 700px;'>*)\n\t\t\t\tThere are two bugs in the Ethereum Name Service (ENS) that allow the ENS DAO to seize ENS names. These flaws make it impossible to create truly immutable names.\n\t\t\t\t<br/>\n\t\t\t\t<a href = 'https://discuss.ens.domains/t/temp-check-executable-revoke-the-daos-ability-to-upgrade-the-name-wrapper/19920/8'>https://discuss.ens.domains/t/temp-check-executable-revoke-the-daos-ability-to-upgrade-the-name-wrapper/19920/8</a>\n\t\t\t</p>\n\t\t</div>\n\t\t<div class = 'text-white/50 text-center'>\n\t\t\t<div class = 'mt-8'>\n\t\t\t\tPetalLock by&nbsp;\n\t\t\t\t<a class = 'text-white hover:underline' href='https://dark.florist'>\n\t\t\t\t\tDark Florist\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t<div class = 'inline-grid'>\n\t\t\t\t<a class = 'text-white hover:underline' href='https://discord.gg/BeFnJA5Kjb'>\n\t\t\t\t\tDiscord\n\t\t\t\t</a>\n\t\t\t\t<a class = 'text-white hover:underline' href='https://twitter.com/DarkFlorist'>\n\t\t\t\t\tTwitter\n\t\t\t\t</a>\n\t\t\t\t<a class = 'text-white hover:underline' href='https://github.com/DarkFlorist'>\n\t\t\t\t\tGithub\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t</main>\n}\n"]}